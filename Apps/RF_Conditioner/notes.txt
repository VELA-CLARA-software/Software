need to clean up logic and functions in main loop
graph updating ? is it time consuming
when to reset the mask?
create a look up table of pulse count vs power(fast??)
use the above table to index current power and increment / decrement on events